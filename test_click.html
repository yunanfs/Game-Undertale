<!DOCTYPE html>
<html>
<head>
    <title>Test Modal Click</title>
    <style>
        body { background: #000; color: #fff; font-family: Arial; padding: 40px; }
        button { background: #fff; color: #000; border: none; padding: 10px 20px; cursor: pointer; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: center; pointer-events: none; visibility: hidden; }
        .modal.active { display: flex; pointer-events: auto; visibility: visible; }
        .modal-content { background: #000; border: 3px solid #fff; padding: 40px; max-width: 500px; text-align: center; }
        .test-chars { margin-top: 30px; }
        .test-char { background: #222; border: 2px solid #fff; padding: 15px; margin: 10px 0; cursor: pointer; }
        .test-char:hover { background: #333; }
    </style>
</head>
<body>
    <h1>Character Modal Test</h1>
    <button onclick="testFetch()">Test API Fetch</button>
    <div id="output" style="margin-top: 20px; background: #1a1a1a; padding: 10px; min-height: 100px; border: 1px solid #0f0; color: #0f0; font-family: monospace; font-size: 0.8rem;"></div>
    
    <div class="test-chars">
        <h2>Try Clicking:</h2>
        <div class="test-char" onclick="showCharacterModal(1)">Character 1</div>
        <div class="test-char" onclick="showCharacterModal(2)">Character 2</div>
    </div>
    
    <div class="modal" id="characterModal">
        <div class="modal-content">
            <h2 id="charName">Character</h2>
            <p id="charDesc">Description</p>
            <button onclick="closeModal('characterModal')">Close</button>
        </div>
    </div>

    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            output.innerHTML += msg + '<br>';
            output.scrollTop = output.scrollHeight;
        }
        
        function testFetch() {
            log('Testing fetch to api/get_character.php?id=1...');
            fetch('api/get_character.php?id=1')
                .then(r => {
                    log(`Response OK: ${r.ok}, Status: ${r.status}`);
                    return r.json();
                })
                .then(data => {
                    log(`JSON: ${JSON.stringify(data)}`);
                })
                .catch(e => {
                    log(`ERROR: ${e.message}`);
                });
        }
        
        function showCharacterModal(charId) {
            log(`showCharacterModal(${charId}) called`);
            const modal = document.getElementById('characterModal');
            if (!modal) {
                log('ERROR: Modal not found');
                return;
            }
            log('Modal found, adding active class');
            modal.classList.add('active');
            log(`Modal classes: ${modal.className}`);
            
            document.getElementById('charName').textContent = 'Character ' + charId;
        }
        
        function closeModal(id) {
            log(`closeModal(${id}) called`);
            const modal = document.getElementById(id);
            if (modal) {
                modal.classList.remove('active');
                log('Modal closed');
            }
        }
        
        log('Page loaded');
        log('Function showCharacterModal is: ' + typeof showCharacterModal);
    </script>
</body>
</html>
